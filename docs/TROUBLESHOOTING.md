# BluRay Converter - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ—à–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º

–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ BluRay –¥–∏—Å–∫–æ–≤.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞](#–±—ã—Å—Ç—Ä–∞—è-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞)
2. [–ü—Ä–æ–±–ª–µ–º—ã —Å–µ—Ç–∏](#–ø—Ä–æ–±–ª–µ–º—ã-—Å–µ—Ç–∏)
3. [–ü—Ä–æ–±–ª–µ–º—ã Docker](#–ø—Ä–æ–±–ª–µ–º—ã-docker)
4. [–ü—Ä–æ–±–ª–µ–º—ã SMB](#–ø—Ä–æ–±–ª–µ–º—ã-smb)
5. [–ü—Ä–æ–±–ª–µ–º—ã FFmpeg](#–ø—Ä–æ–±–ª–µ–º—ã-ffmpeg)
6. [–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞](#–ø—Ä–æ–±–ª–µ–º—ã-—Å-–ø—Ä–∞–≤–∞–º–∏-–¥–æ—Å—Ç—É–ø–∞)
7. [–ü—Ä–æ–±–ª–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#–ø—Ä–æ–±–ª–µ–º—ã-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
8. [–ü—Ä–æ–±–ª–µ–º—ã Telegram](#–ø—Ä–æ–±–ª–µ–º—ã-telegram)
9. [–ü—Ä–æ–±–ª–µ–º—ã Web UI](#–ø—Ä–æ–±–ª–µ–º—ã-web-ui)
10. [–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏](#–ø—Ä–æ–±–ª–µ–º—ã-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

## –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏ –ø—Ä–∏ –ª—é–±–æ–π –ø—Ä–æ–±–ª–µ–º–µ

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
./scripts/test-connection.sh

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
./scripts/deploy-nas.sh status
./scripts/deploy-mac.sh status

# 3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
./scripts/deploy-nas.sh logs
./scripts/deploy-mac.sh logs
```

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø—Ä–æ–±–ª–µ–º
- üî¥ **–°–µ—Ä–≤–∏—Å—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è** ‚Üí –ü—Ä–æ–±–ª–µ–º—ã Docker –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üü° **–ó–∞–¥–∞—á–∏ –∑–∞–≤–∏—Å–∞—é—Ç –≤ —Å—Ç–∞—Ç—É—Å–µ "pending"** ‚Üí –ü—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∏ NAS-Mac
- üü† **–ó–∞–¥–∞—á–∏ –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–æ–π** ‚Üí –ü—Ä–æ–±–ª–µ–º—ã FFmpeg –∏–ª–∏ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
- üîµ **Web UI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** ‚Üí –ü—Ä–æ–±–ª–µ–º—ã —Å–µ—Ç–∏ –∏–ª–∏ Nginx

## –ü—Ä–æ–±–ª–µ–º—ã —Å–µ—Ç–∏

### NAS –∏ Mac mini –Ω–µ –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö
- –ó–∞–¥–∞—á–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ Mac
- API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ ping –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
ping 192.168.1.50  # IP NAS
ping 192.168.1.100 # IP Mac mini

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–æ–≤
nc -z 192.168.1.50 8080  # NAS API
nc -z 192.168.1.100 8000 # Mac Worker
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ IP –∞–¥—Ä–µ—Å–∞**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –æ–±–æ–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ IP
2. **Firewall**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –Ω–∞ NAS
3. **–†–æ—É—Ç–µ—Ä**: –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ä–æ—É—Ç–µ—Ä, –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç—å—é

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–µ—Ç—å

**–°–∏–º–ø—Ç–æ–º—ã:**
- –î–æ–ª–≥–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤
- –¢–∞–π–º–∞—É—Ç—ã –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ

**–†–µ—à–µ–Ω–∏—è:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–µ—Ç–∏
iperf3 -s  # –ù–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
iperf3 -c 192.168.1.50  # –ù–∞ –¥—Ä—É–≥–æ–º

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≤–æ–¥–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É —Å–µ—Ç–∏ –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
```

## –ü—Ä–æ–±–ª–µ–º—ã Docker

### Docker –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ NAS

**–°–∏–º–ø—Ç–æ–º—ã:**
```
ERROR: Couldn't connect to Docker daemon
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Docker:**
   ```bash
   sudo synopkg stop Docker
   sudo synopkg start Docker
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã:**
   - –ú–∏–Ω–∏–º—É–º 2GB RAM
   - –ú–∏–Ω–∏–º—É–º 10GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

3. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
   ```bash
   sudo usermod -aG docker admin
   ```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°—Ç–∞—Ç—É—Å "Exited" —É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –û—à–∏–±–∫–∏ –≤ `docker-compose ps`

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏
docker-compose logs service_name

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker-compose config
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–û—á–∏—Å—Ç–∏—Ç–µ –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ:**
   ```bash
   ./scripts/reset-system.sh containers
   ./scripts/deploy-nas.sh
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª—ã:**
   - –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
   - –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞

### Docker –Ω–∞ Mac mini

**–ü—Ä–æ–±–ª–µ–º–∞:** Docker Desktop –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Docker Desktop**
2. **–£–≤–µ–ª–∏—á—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã Docker:**
   - Memory: –º–∏–Ω–∏–º—É–º 4GB
   - Disk: –º–∏–Ω–∏–º—É–º 50GB
3. **–û–±–Ω–æ–≤–∏—Ç–µ Docker Desktop –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏**

## –ü—Ä–æ–±–ª–µ–º—ã SMB

### Mac –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ NAS

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ª–æ–≥–∞—Ö worker
- "Mount failed" –≤ Mac –ª–æ–≥–∞—Ö

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å SMB –ø–æ—Ä—Ç–∞
nc -z 192.168.1.50 445

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SMB —Å–ª—É–∂–±—É –Ω–∞ NAS
smbutil view //192.168.1.50
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ SMB:**
   ```bash
   # –í mac-services/.env
   SMB_USERNAME=–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
   SMB_PASSWORD=–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_–ø–∞—Ä–æ–ª—å
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ SMB –Ω–∞ NAS:**
   - Control Panel ‚Üí File Services ‚Üí SMB
   - –í–∫–ª—é—á–∏—Ç–µ SMB service
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è SMB: SMB2

3. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å RW –¥–æ—Å—Ç—É–ø –∫ shared folder

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä—É—Å—Å–∫–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ —Ñ–∞–π–ª–æ–≤

**–°–∏–º–ø—Ç–æ–º—ã:**
- –§–∞–π–ª—ã —Å —Ä—É—Å—Å–∫–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- –û—à–∏–±–∫–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –≤ –ª–æ–≥–∞—Ö

**–†–µ—à–µ–Ω–∏—è:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–¥–∏—Ä–æ–≤–∫—É –≤ Docker
# –î–æ–±–∞–≤—å—Ç–µ –≤ docker-compose.yml:
environment:
  - LANG=ru_RU.UTF-8
  - LC_ALL=ru_RU.UTF-8
```

## –ü—Ä–æ–±–ª–µ–º—ã FFmpeg

### FFmpeg –Ω–µ –Ω–∞–π–¥–µ–Ω

**–°–∏–º–ø—Ç–æ–º—ã:**
```
ERROR: ffmpeg not found in container
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:**
   ```bash
   cd mac-services
   docker-compose build --no-cache worker
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Dockerfile:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ FFmpeg —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

### –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ BDMV

**–°–∏–º–ø—Ç–æ–º—ã:**
- "Invalid BDMV structure"
- "No playlist found"
- –ü—É—Å—Ç—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É BluRay
ls -la "/volume1/video/–ö–∏–Ω–æ/BluRayRAW/Movie (2023)/BDMV/"
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–∞–ø–∫–∏: PLAYLIST, STREAM, CLIPINF

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ls -la "/volume1/video/–ö–∏–Ω–æ/BluRayRAW/Movie (2023)/"
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ BDMV:**
   ```
   Movie (2023)/
   ‚îî‚îÄ‚îÄ BDMV/
       ‚îú‚îÄ‚îÄ PLAYLIST/    # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
       ‚îú‚îÄ‚îÄ STREAM/      # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ  
       ‚îî‚îÄ‚îÄ CLIPINF/     # –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤:**
   - –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∏–ª—å–º –æ–±—ã—á–Ω–æ —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π .mpls —Ñ–∞–π–ª

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ FFmpeg

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—á–µ–Ω—å –¥–æ–ª–≥–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
- –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CPU

**–†–µ—à–µ–Ω–∏—è:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –≤ .env
FFMPEG_THREADS=8  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä CPU

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–π preset
FFMPEG_PRESET=fast  # –í–º–µ—Å—Ç–æ slow
```

## –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

### –û—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

**–°–∏–º–ø—Ç–æ–º—ã:**
- "Permission denied"
- "Cannot create directory"
- –§–∞–π–ª—ã –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ls -la /volume1/video/–ö–∏–Ω–æ/
ls -la /volume1/video/–ö–∏–Ω–æ/BluRayRAW/
```

**–†–µ—à–µ–Ω–∏—è:**
```bash
# –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
sudo chown -R admin:users /volume1/video/–ö–∏–Ω–æ/
sudo chmod -R 775 /volume1/video/–ö–∏–Ω–æ/

# –î–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–∞–ø–æ–∫:
sudo chmod 775 /volume1/video/–ö–∏–Ω–æ/BluRayRAW/
sudo chmod 775 /volume1/video/–ö–∏–Ω–æ/BluRayProcessed/
sudo chmod 775 /volume1/video/–ö–∏–Ω–æ/BluRayTemp/
```

### Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ**
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –≤ docker-compose:**
   ```yaml
   volumes:
     - /volume1/video:/volume1/video:rw
   ```

## –ü—Ä–æ–±–ª–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- "Database is locked"
- "Database disk image is malformed"
- API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ –±–∞–∑—ã

**–†–µ—à–µ–Ω–∏—è:**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã
cd nas-services && docker-compose down

# –°–æ–∑–¥–∞–π—Ç–µ –±—ç–∫–∞–ø –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–æ–π –ë–î
cp volumes/db/tasks.db volumes/db/tasks.db.backup

# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
sqlite3 volumes/db/tasks.db ".recover" | sqlite3 volumes/db/tasks_recovered.db

# –ò–ª–∏ –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å
./scripts/reset-system.sh database
```

### –ó–∞–¥–∞—á–∏ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ñ–∏–ª—å–º—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–∂–µ –≥–æ—Ç–æ–≤—ã—Ö —Ñ–∏–ª—å–º–æ–≤

**–†–µ—à–µ–Ω–∏—è:**
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã —á–µ—Ä–µ–∑ API
curl -X POST http://192.168.1.50:8080/api/maintenance/cleanup

# –ò–ª–∏ –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –±–∞–∑—ã
./scripts/reset-system.sh database
```

## –ü—Ä–æ–±–ª–µ–º—ã Telegram

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç—É –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
curl -s "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/getMe"
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ .env:**
   ```bash
   TELEGRAM_BOT_TOKEN=–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_—Ç–æ–∫–µ–Ω
   TELEGRAM_CHAT_ID=–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π_chat_id
   ```

2. **–ü–æ–ª—É—á–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π chat_id:**
   ```bash
   # –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É, –∑–∞—Ç–µ–º:
   curl -s "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/getUpdates" | grep -o '"id":[0-9]*'
   ```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

**–†–µ—à–µ–Ω–∏—è:**
1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã:**
   ```bash
   TELEGRAM_NOTIFICATIONS=true
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É —Å NAS**

## –ü—Ä–æ–±–ª–µ–º—ã Web UI

### Web UI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–°–∏–º–ø—Ç–æ–º—ã:**
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- 502 Bad Gateway
- Connection refused

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å nginx
docker-compose ps web-ui

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç
nc -z localhost 8081
```

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ web-ui —Å–µ—Ä–≤–∏—Å:**
   ```bash
   cd nas-services
   docker-compose restart web-ui
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç –≤ .env:**
   ```bash
   WEB_UI_PORT=8081  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≤–æ–±–æ–¥–µ–Ω
   ```

### API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- CORS –æ—à–∏–±–∫–∏
- API –∑–∞–ø—Ä–æ—Å—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–†–µ—à–µ–Ω–∏—è:**
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
2. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω:**
   ```bash
   curl http://localhost:8080/api/health
   ```

## –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- –í—ã—Å–æ–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã

**–†–µ—à–µ–Ω–∏—è:**
1. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ FFmpeg:**
   ```bash
   # –í mac-services/.env
   FFMPEG_THREADS=0      # –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
   FFMPEG_PRESET=medium  # –ë–∞–ª–∞–Ω—Å —Å–∫–æ—Ä–æ—Å—Ç—å/–∫–∞—á–µ—Å—Ç–≤–æ
   ```

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤:**
   ```bash
   # –ù–∞ Mac mini
   htop
   iostat -x 1
   
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ
   df -h
   ```

### –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∏—Å–∫–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- "No space left on device"
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏—è:**
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
./scripts/reset-system.sh temp

# –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏–∑ Processed
mv "/volume1/video/–ö–∏–Ω–æ/BluRayProcessed/*.mkv" "/volume1/video/Movies/"

# –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
```

## –ê–≤–∞—Ä–∏–π–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å —Å–∏—Å—Ç–µ–º—ã

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:
```bash
# 1. –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å
./scripts/reset-system.sh --force

# 2. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ
./scripts/deploy-nas.sh
./scripts/deploy-mac.sh

# 3. –¢–µ—Å—Ç
./scripts/test-connection.sh
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
tar -xzf bluray-converter-config.tar.gz

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å—ã
./scripts/deploy-nas.sh
./scripts/deploy-mac.sh
```

## –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

### –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç
./scripts/test-connection.sh > system-report.txt

# –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏
./scripts/deploy-nas.sh logs >> system-report.txt
./scripts/deploy-mac.sh logs >> system-report.txt

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
uname -a >> system-report.txt
docker version >> system-report.txt
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker-compose logs -f

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
docker exec -it container_name bash

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker exec container_name ping 192.168.1.50

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
docker exec container_name ps aux
```

---

**–°–æ–≤–µ—Ç:** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º —Ä–µ—à–∞–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Ç–µ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å `./scripts/test-connection.sh`.