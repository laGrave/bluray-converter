# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ Blu-ray –≤ MKV

## –í–ê–ñ–ù–û: –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è LLM

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (LLM):
–í—ã –±—É–¥–µ—Ç–µ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç—É —Å–∏—Å—Ç–µ–º—É –Ω–∞ Mac, –∫–æ—Ç–æ—Ä—ã–π –ù–ï —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–ª–µ–≤—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ (Synology NAS –∏–ª–∏ Mac mini —Å Apple Silicon). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

1. **–í—ã –ù–ï —Å–º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ** - –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Synology NAS –∏–ª–∏ —Ü–µ–ª–µ–≤–æ–º—É Mac mini
2. **–í–∞—à–∞ –∑–∞–¥–∞—á–∞** - —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—É—é –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—É —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
3. **–ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω–∞–¥–µ–∂–Ω—ã–º** - —É –≤–∞—Å –Ω–µ –±—É–¥–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–ª–∞–¥–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
4. **–û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª–∏—Ç–µ**:
   - –û–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫ –∏ edge cases
   - –î–µ—Ç–∞–ª—å–Ω–æ–º—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–µ –≤—Å–µ—Ö –ø—É—Ç–µ–π –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
   - Graceful –æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
   - –ü–æ–¥—Ä–æ–±–Ω—ã–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º –≤ –∫–æ–¥–µ
   - –í–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

5. **Deliverables (—á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–æ)**:
   - –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏
   - Docker-–æ–±—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
   - –°–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –æ—Ç–ª–∞–¥–∫–µ
   - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
   - –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º

6. **–ü—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –æ–± –æ–∫—Ä—É–∂–µ–Ω–∏–∏**:
   - Synology NAS –∏–º–µ–µ—Ç Docker, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
   - Mac mini –∏–º–µ–µ—Ç Docker Desktop –¥–ª—è Mac (ARM –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Apple Silicon)
   - –°–µ—Ç—å –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ - –ª–æ–∫–∞–ª—å–Ω–∞—è, 1 –ì–±–∏—Ç/—Å
   - –ü—É—Ç–∏ –Ω–∞ NAS –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å /volume1/

7. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –°–æ–∑–¥–∞–π—Ç–µ unit-—Ç–µ—Å—Ç—ã –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
   - –î–æ–±–∞–≤—å—Ç–µ mock-—Ä–µ–∂–∏–º –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –í–∫–ª—é—á–∏—Ç–µ dry-run —Ä–µ–∂–∏–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

8. **–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π**:
   - **–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –≤—ã–±–∏—Ä–∞–π—Ç–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç, –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—è –ø—Ä–∏–Ω—è—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ –∫–æ–¥–µ**
   - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –º–µ–∂–¥—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é - –≤—ã–±–∏—Ä–∞–π—Ç–µ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
   - –í—Å–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –∏ —Ä–µ—à–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

## 1. –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1.1 –ò—Å—Ö–æ–¥–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è
–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å:
- **Synology NAS** - —Å–µ—Ç–µ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –≥–¥–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –º–µ–¥–∏–∞—Å–µ—Ä–≤–µ—Ä Plex –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∏–ª—å–º–æ–≤
- **Mac mini —Å –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º Apple Silicon (M-series)** - –∫–æ–º–ø—å—é—Ç–µ—Ä –≤ –¥–æ–º–∞—à–Ω–µ–π —Å–µ—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–∞–∫ –±–∏–ª–¥-—Å–µ—Ä–≤–µ—Ä, –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç 99% –≤—Ä–µ–º–µ–Ω–∏
- **–ö–æ–ª–ª–µ–∫—Ü–∏—è —Ñ–∏–ª—å–º–æ–≤** –≤ —Ñ–æ—Ä–º–∞—Ç–µ Blu-ray (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ BDMV)

### 1.2 –ü—Ä–æ–±–ª–µ–º–∞
Plex –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–∞—Ç–∏–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ Blu-ray –¥–∏—Å–∫–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ BDMV. –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —á–µ—Ä–µ–∑ Plex —Ñ–∏–ª—å–º—ã –Ω—É–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç MKV.

### 1.3 –†–µ—à–µ–Ω–∏–µ
–°–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è:
1. –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ Blu-ray —Ñ–∏–ª—å–º—ã –Ω–∞ NAS
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∏—Ö –≤ MKV –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (remux)
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å—Ç–∞–∏–≤–∞—é—â–µ–≥–æ Mac mini –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. –£–≤–µ–¥–æ–º–ª—è–µ—Ç –æ —Å—Ç–∞—Ç—É—Å–µ —á–µ—Ä–µ–∑ Telegram
5. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —á–∞—Å—Ç–µ–π:
- **–£–ø—Ä–∞–≤–ª—è—é—â–∞—è —á–∞—Å—Ç—å –Ω–∞ NAS** - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é, –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∞—è —á–∞—Å—Ç—å –Ω–∞ Mac mini** - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ REST API –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏.

## 3. –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 3.1 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ NAS (Synology)
- **Watcher Service** - —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É —Å Blu-ray —Ñ–∏–ª—å–º–∞–º–∏, –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–µ
- **API Service** - REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π –∏ –ø—Ä–∏–µ–º–∞ webhook –æ—Ç Mac mini
- **Web UI** - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ—á–µ—Ä–µ–¥–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **Scheduler** - –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- **SQLite DB** - —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–¥–∞—á–∞—Ö –∏ –∏—Å—Ç–æ—Ä–∏–∏
- **Telegram Bot** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ

### 3.2 –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ Mac mini
- **Worker API** - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–¥–∞—á–∏ –æ—Ç NAS
- **Processor** - –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é —á–µ—Ä–µ–∑ FFmpeg

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –Ω–∞ NAS
```
/volume1/video/–ö–∏–Ω–æ/
‚îú‚îÄ‚îÄ BluRayRAW/          # –°—é–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∞–¥–µ—Ç Blu-ray —Ñ–∏–ª—å–º—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ MovieName/      # –ö–∞–∂–¥—ã–π —Ñ–∏–ª—å–º - –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ BDMV/       # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Blu-ray –¥–∏—Å–∫–∞
‚îú‚îÄ‚îÄ BluRayProcessed/    # –°—é–¥–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–ª–∞–¥–µ—Ç –≥–æ—Ç–æ–≤—ã–µ MKV —Ñ–∞–π–ª—ã
‚îî‚îÄ‚îÄ BluRayTemp/         # –í—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–ø–∫–∞ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
```

## 5. –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 5.1 –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π
1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –∫–æ–ø–∏—Ä—É–µ—Ç Blu-ray —Ñ–∏–ª—å–º –≤ –ø–∞–ø–∫—É BluRayRAW
2. **–°–∏—Å—Ç–µ–º–∞** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ –≤ 3:00) –∏–ª–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É
3. **–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ñ–∏–ª—å–º–∞:**
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–¥–∞—á–∞ –≤ –æ—á–µ—Ä–µ–¥–∏
   - –ó–∞–¥–∞—á–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ Mac mini
   - Mac mini –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –ø–∞–ø–∫–∏ NAS —á–µ—Ä–µ–∑ SMB
   - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç BDMV —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–∞—Ö–æ–¥–∏—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∏–ª—å–º (—Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π)
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ MKV –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (remux) –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ BluRayTemp
   - –£–≤–µ–¥–æ–º–ª—è–µ—Ç NAS –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
4. **NAS –ø–æ–ª—É—á–∏–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:**
   - –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª –∏–∑ BluRayTemp –≤ BluRayProcessed
   - –£–¥–∞–ª—è–µ—Ç –∏—Å—Ö–æ–¥–Ω–∏–∫ –∏–∑ BluRayRAW
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** –≤—Ä—É—á–Ω—É—é –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç —Ñ–∏–ª—å–º –∏–∑ BluRayProcessed –≤ –æ—Å–Ω–æ–≤–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É Plex

### 5.2 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ï—Å–ª–∏ Mac mini –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: 3 –ø–æ–ø—ã—Ç–∫–∏ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 30 –º–∏–Ω—É—Ç
- –ï—Å–ª–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å: 2 –ø–æ–ø—ã—Ç–∫–∏, –∑–∞—Ç–µ–º –ø–æ–º–µ—Ç–∫–∞ –∫–∞–∫ –æ—à–∏–±–∫–∞
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Telegram

## 6. –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### 6.1 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite)
–¢–∞–±–ª–∏—Ü—ã:
- **tasks** - –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á
  - id, movie_name, status, created_at, updated_at, attempts
  - –°—Ç–∞—Ç—É—Å—ã: pending, sent, processing, completed, failed, retrying
- **processing_history** - –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç–æ–∫
- **errors** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫
- **statistics** - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ä—à–µ 60 –¥–Ω–µ–π.

### 6.2 Web UI —Ñ—É–Ω–∫—Ü–∏–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–µ–π –æ—á–µ—Ä–µ–¥–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–ø–∫–∏
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞
- –£–¥–∞–ª–µ–Ω–∏–µ/–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∑–∞–¥–∞—á
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤
- –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 6.3 Telegram –±–æ—Ç
–°–æ–æ–±—â–µ–Ω–∏—è:
- "üé¨ –ù–∞—á–∞—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞: MovieName"
- "‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω: MovieName (–≤—Ä–µ–º—è: 45 –º–∏–Ω)"
- "‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏: MovieName - –¥–µ—Ç–∞–ª–∏"

–ö–æ–º–∞–Ω–¥—ã:
- /queue - –ø–æ–∫–∞–∑–∞—Ç—å –æ—á–µ—Ä–µ–¥—å
- /scan - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- /cancel - –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É

### 6.4 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ ENV —Ñ–∞–π–ª—ã
```env
# nas-services/.env
MAC_MINI_IP=192.168.1.100
MAC_MINI_PORT=8000
NAS_IP=192.168.1.50
NAS_PORT=8080
TELEGRAM_BOT_TOKEN=your_token_here
TELEGRAM_CHAT_ID=your_chat_id
SCAN_SCHEDULE="0 3 * * *"  # cron —Ñ–æ—Ä–º–∞—Ç

# –ü—É—Ç–∏ –∫ –ø–∞–ø–∫–∞–º (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ–¥ —Å–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É)
MOVIES_BASE_PATH=/volume1/video/–ö–∏–Ω–æ
BLURAY_RAW_FOLDER=BluRayRAW
BLURAY_PROCESSED_FOLDER=BluRayProcessed
BLURAY_TEMP_FOLDER=BluRayTemp

# SMB –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Mac mini
SMB_USERNAME=nas_user
SMB_SHARE_NAME=video
```

```env
# mac-services/.env
NAS_IP=192.168.1.50
NAS_API_PORT=8080
WORKER_PORT=8000

# –ü—É—Ç–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
MOUNT_POINT=/mnt/nas
SMB_USERNAME=nas_user
SMB_PASSWORD=secure_password

# FFmpeg –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
FFMPEG_THREADS=0  # 0 = auto
FFMPEG_PRESET=slow
```

## 7. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### NAS —Å–µ—Ä–≤–∏—Å—ã:
- Python 3.11+
- FastAPI - –¥–ª—è REST API
- SQLite - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- APScheduler - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
- python-telegram-bot - Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- HTML/CSS/JavaScript + Alpine.js - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- Chart.js - –≥—Ä–∞—Ñ–∏–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- Docker + Docker Compose - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

### Mac mini —Å–µ—Ä–≤–∏—Å—ã:
- Python 3.11+
- FastAPI - REST API —Å–µ—Ä–≤–µ—Ä
- FFmpeg - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤–∏–¥–µ–æ
- smbprotocol –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π mount - –¥–æ—Å—Ç—É–ø –∫ NAS
- Docker + Docker Compose - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## 8. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
blu-ray-converter/
‚îú‚îÄ‚îÄ nas-services/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îú‚îÄ‚îÄ .env.example
‚îÇ   ‚îú‚îÄ‚îÄ watcher/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ scanner.py           # –õ–æ–≥–∏–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–ø–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db_manager.py        # –†–∞–±–æ—Ç–∞ —Å SQLite
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mac_client.py        # –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–¥–∞—á –Ω–∞ Mac
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes.py            # API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ webhook.py           # –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç Mac
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ file_manager.py      # –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telegram_bot.py      # Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ scheduler/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scheduler.py         # Cron –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ web-ui/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nginx.conf
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html           # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ style.css            # –°—Ç–∏–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.js               # –õ–æ–≥–∏–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.js               # –†–∞–±–æ—Ç–∞ —Å API
‚îÇ   ‚îî‚îÄ‚îÄ volumes/
‚îÇ       ‚îú‚îÄ‚îÄ db/                  # SQLite –±–∞–∑–∞
‚îÇ       ‚îî‚îÄ‚îÄ logs/                # –õ–æ–≥–∏
‚îÇ
‚îú‚îÄ‚îÄ mac-services/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îú‚îÄ‚îÄ .env.example
‚îÇ   ‚îú‚îÄ‚îÄ worker/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py              # FastAPI —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ processor.py         # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bdmv_analyzer.py     # –ê–Ω–∞–ª–∏–∑ Blu-ray —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ffmpeg_wrapper.py    # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è FFmpeg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ nas_client.py        # Webhook –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ NAS
‚îÇ   ‚îî‚îÄ‚îÄ volumes/
‚îÇ       ‚îî‚îÄ‚îÄ logs/                # –õ–æ–≥–∏
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ deploy-nas.sh            # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ NAS
‚îÇ   ‚îú‚îÄ‚îÄ deploy-mac.sh            # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Mac
‚îÇ   ‚îú‚îÄ‚îÄ test-connection.sh       # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏
‚îÇ   ‚îî‚îÄ‚îÄ reset-system.sh          # –°–±—Ä–æ—Å —Å–∏—Å—Ç–µ–º—ã
‚îÇ
‚îî‚îÄ‚îÄ docs/
    ‚îú‚îÄ‚îÄ SETUP.md                 # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ
    ‚îú‚îÄ‚îÄ USAGE.md                 # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚îî‚îÄ‚îÄ TROUBLESHOOTING.md       # –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
```

## 9. API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### NAS API endpoints:
```
GET  /api/tasks                 # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á
POST /api/tasks/scan            # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
POST /api/tasks/{id}/restart    # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É
DELETE /api/tasks/{id}          # –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É
POST /api/tasks/{id}/priority   # –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ –æ—á–µ—Ä–µ–¥–∏
GET  /api/logs                  # –ü–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏
GET  /api/statistics            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
POST /api/webhook/status        # Webhook –¥–ª—è Mac mini
GET  /api/health                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
```

### Mac mini API endpoints:
```
POST /api/process               # –ü–æ–ª—É—á–∏—Ç—å –∏ –Ω–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–¥–∞—á–∏
GET  /api/health                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
GET  /api/status/{task_id}      # –°—Ç–∞—Ç—É—Å —Ç–µ–∫—É—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
```

## 10. Webhook —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

Mac mini ‚Üí NAS –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏:
```json
{
  "task_id": "123",
  "status": "completed",
  "temp_file": "MovieName.mkv",
  "source_folder": "MovieName",
  "processing_time": 2700,
  "file_size_mb": 45000
}
```

–ü—Ä–∏ –æ—à–∏–±–∫–µ:
```json
{
  "task_id": "123",
  "status": "failed",
  "error": "FFmpeg error: Invalid BDMV structure",
  "source_folder": "MovieName"
}
```

## 11. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

### 11.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ NAS:
1. –í–∫–ª—é—á–∏—Ç—å SSH –¥–æ—Å—Ç—É–ø –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker —á–µ—Ä–µ–∑ Package Center
3. –°–æ–∑–¥–∞—Ç—å shared folder –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

### 11.2 –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ NAS:
```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ SSH
ssh admin@nas-ip

# 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
git clone https://github.com/user/blu-ray-converter.git
cd blu-ray-converter/nas-services

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cp .env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å
./scripts/deploy-nas.sh
```

### 11.3 –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Mac mini:
```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker Desktop –¥–ª—è Mac
# 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
git clone https://github.com/user/blu-ray-converter.git
cd blu-ray-converter/mac-services

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cp .env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å
./scripts/deploy-mac.sh
```

## 12. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å `restart: always` –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–æ—Ç–∞—Ü–∏–µ–π (–º–∞–∫—Å–∏–º—É–º 100MB –Ω–∞ —Ñ–∞–π–ª)
- Graceful shutdown –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- Health checks –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (email, Discord)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

## 13. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 13.1 –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞–ø–∏—Å–∞–Ω —Å —É—á–µ—Ç–æ–º –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ù–∏–∫–∞–∫–∏—Ö hardcoded –ø—É—Ç–µ–π –∏–ª–∏ IP-–∞–¥—Ä–µ—Å–æ–≤

### 13.2 Mock-—Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –≤ mock-—Ä–µ–∂–∏–º–µ:
- –≠–º—É–ª—è—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã NAS
- –§–µ–π–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ (sleep –≤–º–µ—Å—Ç–æ FFmpeg)
- –¢–µ—Å—Ç–æ–≤—ã–µ webhook –≤—ã–∑–æ–≤—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ verbose —Ä–µ–∂–∏–º–µ

### 13.3 –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
–°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- `check-nas-connection.sh` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ NAS
- `check-mac-connection.sh` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ —Å Mac mini
- `validate-config.sh` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `test-ffmpeg.sh` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã FFmpeg
- `test-telegram.sh` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

### 13.4 –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –æ—Ç–ª–∞–¥–∫–µ
–°–æ–∑–¥–∞—Ç—å TROUBLESHOOTING.md —Å —Ä–µ—à–µ–Ω–∏—è–º–∏ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º:
- –û—à–∏–±–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è SMB
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
- –û—à–∏–±–∫–∏ —Å–µ—Ç–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å Docker –Ω–∞ Synology
- –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ FFmpeg

## 14. –ü–ª–∞–Ω –ø–æ—à–∞–≥–æ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (30 –º–∏–Ω—É—Ç)
1. –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞–∑–¥–µ–ª—É 8
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git init
   git add .
   git commit -m "Initial project structure"
   ```
3. –°–æ–∑–¥–∞—Ç—å –≤—Å–µ –ø—É—Å—Ç—ã–µ —Ñ–∞–π–ª—ã —Å –±–∞–∑–æ–≤—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
4. –°–æ–∑–¥–∞—Ç—å README.md —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞
5. –ö–æ–º–º–∏—Ç: `git commit -m "Add empty files with basic headers"`

### Git —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
- –ö–æ–º–º–∏—Ç–∏—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π —Ñ–∞–∑—ã
- –ö–æ–º–º–∏—Ç–∏—Ç—å –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–∏–º–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ
- –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–º–∏—Ç–æ–≤:
  - `feat: Add database schema and models`
  - `feat: Implement BDMV analyzer`
  - `feat: Add FFmpeg wrapper with progress tracking`
  - `fix: Handle SMB connection timeout`
  - `docs: Add troubleshooting guide`

### –§–∞–∑–∞ 2: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (1 —á–∞—Å)
1. –°–æ–∑–¥–∞—Ç—å docker-compose.yml –¥–ª—è NAS –∏ Mac
2. –ù–∞–ø–∏—Å–∞—Ç—å Dockerfile –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
3. –°–æ–∑–¥–∞—Ç—å .env.example —Ñ–∞–π–ª—ã —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ requirements.txt

### –§–∞–∑–∞ 3: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–∏ (1.5 —á–∞—Å–∞)
1. –°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É SQLite –≤ `nas-services/api/models.py`:
   ```python
   # –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   CREATE TABLE tasks (
       id INTEGER PRIMARY KEY,
       movie_name TEXT NOT NULL,
       source_path TEXT NOT NULL,
       status TEXT NOT NULL,
       priority INTEGER DEFAULT 0,
       attempts INTEGER DEFAULT 0,
       created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
       updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
       processing_started_at TIMESTAMP,
       processing_completed_at TIMESTAMP,
       error_message TEXT
   );
   ```
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å db_manager.py —Å –º–µ—Ç–æ–¥–∞–º–∏:
   - create_task()
   - get_pending_tasks()
   - update_task_status()
   - get_task_history()
   - cleanup_old_records()

### –§–∞–∑–∞ 4: NAS Watcher Service (2 —á–∞—Å–∞)
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å scanner.py:
   ```python
   # –ü—Å–µ–≤–¥–æ–∫–æ–¥ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ª–æ–≥–∏–∫–∏
   def scan_directory():
       # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—É—Ç–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
       base_path = os.getenv("MOVIES_BASE_PATH")
       raw_folder = os.getenv("BLURAY_RAW_FOLDER")
       raw_path = os.path.join(base_path, raw_folder)
       
       for folder in os.listdir(raw_path):
           if has_bdmv_structure(folder) and not is_processed(folder):
               create_task(folder)
   ```
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å mac_client.py –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–¥–∞—á
3. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
4. –ö–æ–º–º–∏—Ç: `git commit -m "feat: Implement NAS watcher service with configurable paths"`

### –§–∞–∑–∞ 5: Mac Worker Service (3 —á–∞—Å–∞)
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å bdmv_analyzer.py:
   ```python
   # –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–ª–µ–π–ª–∏—Å—Ç–∞
   def find_main_playlist(bdmv_path):
       playlist_dir = os.path.join(bdmv_path, "BDMV/PLAYLIST")
       # –ù–∞–π—Ç–∏ —Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π .mpls —Ñ–∞–π–ª
       # –í–µ—Ä–Ω—É—Ç—å –ø—É—Ç—å –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –≤–∏–¥–µ–æ
   ```
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ffmpeg_wrapper.py:
   ```bash
   # –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã FFmpeg –¥–ª—è remux
   ffmpeg -i bluray:"/path/to/BDMV" -c copy -map 0 output.mkv
   ```
3. –°–æ–∑–¥–∞—Ç—å processor.py —Å –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –§–∞–∑–∞ 6: API –∏ Webhook (2 —á–∞—Å–∞)
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å FastAPI endpoints –Ω–∞ NAS
2. –°–æ–∑–¥–∞—Ç—å webhook handler –¥–ª—è –ø—Ä–∏–µ–º–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ—Ç Mac
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å file_manager.py –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:
   ```python
   def move_processed_file(temp_file, final_name):
       # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—É—Ç–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
       base_path = os.getenv("MOVIES_BASE_PATH")
       temp_folder = os.getenv("BLURAY_TEMP_FOLDER")
       processed_folder = os.getenv("BLURAY_PROCESSED_FOLDER")
       
       # –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ NAS
       shutil.move(
           os.path.join(base_path, temp_folder, temp_file),
           os.path.join(base_path, processed_folder, final_name)
       )
   ```
4. –ö–æ–º–º–∏—Ç: `git commit -m "feat: Add API endpoints and webhook handler"`

### –§–∞–∑–∞ 7: Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1 —á–∞—Å)
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å telegram_bot.py —Å –∫–æ–º–∞–Ω–¥–∞–º–∏
2. –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –§–∞–∑–∞ 8: Web UI (2 —á–∞—Å–∞)
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ HTML/CSS/JS
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Alpine.js –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
3. –î–æ–±–∞–≤–∏—Ç—å Chart.js –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ polling

### –§–∞–∑–∞ 9: –°–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (1 —á–∞—Å)
1. –°–æ–∑–¥–∞—Ç—å deploy-nas.sh:
   ```bash
   #!/bin/bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   # Docker compose up —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
   # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
   ```
2. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è Mac mini
3. –î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –§–∞–∑–∞ 10: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1 —á–∞—Å)
1. –ù–∞–ø–∏—Å–∞—Ç—å SETUP.md —Å –ø–æ—à–∞–≥–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
2. –°–æ–∑–¥–∞—Ç—å USAGE.md —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å TROUBLESHOOTING.md
4. –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

## 15. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 15.1 –ê–Ω–∞–ª–∏–∑ BDMV —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```python
# –¢–∏–ø–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Blu-ray:
# MovieName/
#   ‚îú‚îÄ‚îÄ BDMV/
#   ‚îÇ   ‚îú‚îÄ‚îÄ PLAYLIST/
#   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00000.mpls  # –û–±—ã—á–Ω–æ –º–µ–Ω—é
#   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 00001.mpls  # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∏–ª—å–º (—Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π)
#   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 00002.mpls  # –î–æ–ø–æ–ª–Ω–µ–Ω–∏—è
#   ‚îÇ   ‚îî‚îÄ‚îÄ STREAM/
#   ‚îÇ       ‚îú‚îÄ‚îÄ 00000.m2ts
#   ‚îÇ       ‚îî‚îÄ‚îÄ 00001.m2ts
#   ‚îî‚îÄ‚îÄ CERTIFICATE/

# –ù–∞–π—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∏–ª—å–º –ø–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```

### 15.2 FFmpeg –∫–æ–º–∞–Ω–¥—ã
```bash
# –î–ª—è –ø—Ä—è–º–æ–≥–æ remux –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:
ffmpeg -i "bluray:/path/to/BDMV" -c:v copy -c:a copy -c:s copy output.mkv

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ playlist:
ffmpeg -i "/path/to/BDMV/PLAYLIST/00001.mpls" -c copy output.mkv

# –° –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
ffmpeg -progress pipe:1 -i input -c copy output.mkv
```

### 15.3 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ SMB –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```python
# Mac –¥–æ–ª–∂–µ–Ω –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å NAS —á–µ—Ä–µ–∑ SMB
# –ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
mount_command = f"mount -t smbfs //{NAS_USER}:{NAS_PASS}@{NAS_IP}/video /mnt/nas"

# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ —Ä–∞–±–æ—Ç–æ–π
if not os.path.exists("/mnt/nas/–ö–∏–Ω–æ/BluRayRAW"):
    raise Exception("NAS not mounted")
```

### 15.4 –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
- IP –∞–¥—Ä–µ—Å–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- –ü–æ—Ä—Ç—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-65535
- –ü—É—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω—ã
- Telegram —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–Ω—ã–π

## 16. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ deliverables:
1. ‚úÖ –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏
2. ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
3. ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Web UI
4. ‚úÖ –†–∞–±–æ—á–∞—è Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
5. ‚úÖ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
6. ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
7. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ–ø–∏—Å–∞–Ω–Ω—ã—Ö error cases
8. ‚úÖ Mock —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç:
- [ ] –ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
- [ ] –í—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- [ ] –ù–µ—Ç hardcoded –∑–Ω–∞—á–µ–Ω–∏–π
- [ ] –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- [ ] Graceful shutdown —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Health checks –æ—Ç–≤–µ—á–∞—é—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

## 17. –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è LLM

### –†–∞–±–æ—Ç–∞ —Å Git:
1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ —Ä–∞–±–æ—Ç—ã
2. **–°–æ–∑–¥–∞–π—Ç–µ .gitignore** —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏:
   ```
   .env
   *.pyc
   __pycache__/
   .DS_Store
   volumes/db/*.db
   volumes/logs/*.log
   ```
3. **–ö–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ** —Å –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏:
   - –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π —Ñ–∞–∑—ã
   - –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –ü—Ä–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ—Ñ–∏–∫—Å—ã: `feat:`, `fix:`, `docs:`, `refactor:`
4. **–ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–º–∏—Ç–æ–≤**:
   ```bash
   git commit -m "feat: Initial project structure"
   git commit -m "feat: Add SQLite database schema"
   git commit -m "feat: Implement BDMV analyzer with playlist detection"
   git commit -m "fix: Handle missing BDMV structure gracefully"
   git commit -m "docs: Add deployment instructions"
   ```

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
1. **–ù–∞—á–Ω–∏—Ç–µ —Å –§–∞–∑—ã 1** –∏ –¥–≤–∏–≥–∞–π—Ç–µ—Å—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
2. **–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≤—Å–µ —Ñ–∞–π–ª—ã** –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –ø–æ–∫–∞ –ø—É—Å—Ç—ã–µ
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** –¥–ª—è –≤—Å–µ—Ö –ø—É—Ç–µ–π –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
4. **–ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥** –ø–æ–¥—Ä–æ–±–Ω–æ, –æ—Å–æ–±–µ–Ω–Ω–æ —Å–ª–æ–∂–Ω—ã–µ –º–µ—Å—Ç–∞
5. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏–∫—É** —á–µ—Ä–µ–∑ mock —Ä–µ–∂–∏–º –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
6. **–ù–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ** - —Å–Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—á–∏–π –∫–æ–¥
7. **–ü—Ä–∏ —Å–æ–º–Ω–µ–Ω–∏—è—Ö** –≤—ã–±–∏—Ä–∞–π—Ç–µ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
8. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ** - —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

### –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
- –í—Å–µ –ø—É—Ç–∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ö–∞–∂–¥–∞—è —Ñ–∞–∑–∞ –∑–∞–∫–æ–º–º–∏—á–µ–Ω–∞ –≤ Git
- Mock —Ä–µ–∂–∏–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é. –£–¥–∞—á–∏!